var e=Object.defineProperty,s=Object.defineProperties,a=Object.getOwnPropertyDescriptors,r=Object.getOwnPropertySymbols,t=Object.prototype.hasOwnProperty,l=Object.prototype.propertyIsEnumerable,i=(s,a,r)=>a in s?e(s,a,{enumerable:!0,configurable:!0,writable:!0,value:r}):s[a]=r,o=(e,s)=>{for(var a in s||(s={}))t.call(s,a)&&i(e,a,s[a]);if(r)for(var a of r(s))l.call(s,a)&&i(e,a,s[a]);return e},n=(e,r)=>s(e,a(r)),c=(e,s)=>{var a={};for(var i in e)t.call(e,i)&&s.indexOf(i)<0&&(a[i]=e[i]);if(null!=e&&r)for(var i of r(e))s.indexOf(i)<0&&l.call(e,i)&&(a[i]=e[i]);return a},d=(e,s,a)=>new Promise((r,t)=>{var l=e=>{try{o(a.next(e))}catch(s){t(s)}},i=e=>{try{o(a.throw(e))}catch(s){t(s)}},o=e=>e.done?r(e.value):Promise.resolve(e.value).then(l,i);o((a=a.apply(e,s)).next())});import{o as m,j as u,p,q as f,u as h,W as x,c as g,r as v,e as y,l as j,T as N,s as w,t as b,O as _,v as A}from"./ui-vendor-1ILoUzQc.js";import{a as D,k,L as P}from"./react-vendor-tk5Uqt6k.js";import{b as S,B as R,I as E}from"./input-BIyE-_9q.js";import{L as O}from"./label-DzAD6Bgn.js";import{C,b as q,d as F,e as I,a as $}from"./card-CzhgRBNg.js";import{S as L}from"./separator-CIcrb7B9.js";import{A as z,a as T}from"./alert-Cab3IIcR.js";import{c as W,a as B,s as Y,b as U}from"./index-BqVvBisL.js";import{b as V,k as G,E as H,l as K}from"./utils-vendor-Cta_gFyS.js";import"./auth-vendor-CP-4ZW6D.js";import"./query-vendor-BmgDZf4n.js";var M="AlertDialog",[Q]=g(M,[m]),Z=m(),J=e=>{const s=e,{__scopeAlertDialog:a}=s,r=c(s,["__scopeAlertDialog"]),t=Z(a);return u.jsx(p,n(o(o({},t),r),{modal:!0}))};J.displayName=M;D.forwardRef((e,s)=>{const a=e,{__scopeAlertDialog:r}=a,t=c(a,["__scopeAlertDialog"]),l=Z(r);return u.jsx(A,n(o(o({},l),t),{ref:s}))}).displayName="AlertDialogTrigger";var X=e=>{const s=e,{__scopeAlertDialog:a}=s,r=c(s,["__scopeAlertDialog"]),t=Z(a);return u.jsx(f,o(o({},t),r))};X.displayName="AlertDialogPortal";var ee=D.forwardRef((e,s)=>{const a=e,{__scopeAlertDialog:r}=a,t=c(a,["__scopeAlertDialog"]),l=Z(r);return u.jsx(_,n(o(o({},l),t),{ref:s}))});ee.displayName="AlertDialogOverlay";var se="AlertDialogContent",[ae,re]=Q(se),te=j("AlertDialogContent"),le=D.forwardRef((e,s)=>{const a=e,{__scopeAlertDialog:r,children:t}=a,l=c(a,["__scopeAlertDialog","children"]),i=Z(r),d=D.useRef(null),m=h(s,d),p=D.useRef(null);return u.jsx(x,{contentName:se,titleName:ie,docsSlug:"alert-dialog",children:u.jsx(ae,{scope:r,cancelRef:p,children:u.jsxs(v,n(o(o({role:"alertdialog"},i),l),{ref:m,onOpenAutoFocus:y(l.onOpenAutoFocus,e=>{var s;e.preventDefault(),null==(s=p.current)||s.focus({preventScroll:!0})}),onPointerDownOutside:e=>e.preventDefault(),onInteractOutside:e=>e.preventDefault(),children:[u.jsx(te,{children:t}),u.jsx(pe,{contentRef:d})]}))})})});le.displayName=se;var ie="AlertDialogTitle",oe=D.forwardRef((e,s)=>{const a=e,{__scopeAlertDialog:r}=a,t=c(a,["__scopeAlertDialog"]),l=Z(r);return u.jsx(N,n(o(o({},l),t),{ref:s}))});oe.displayName=ie;var ne="AlertDialogDescription",ce=D.forwardRef((e,s)=>{const a=e,{__scopeAlertDialog:r}=a,t=c(a,["__scopeAlertDialog"]),l=Z(r);return u.jsx(w,n(o(o({},l),t),{ref:s}))});ce.displayName=ne;var de=D.forwardRef((e,s)=>{const a=e,{__scopeAlertDialog:r}=a,t=c(a,["__scopeAlertDialog"]),l=Z(r);return u.jsx(b,n(o(o({},l),t),{ref:s}))});de.displayName="AlertDialogAction";var me="AlertDialogCancel",ue=D.forwardRef((e,s)=>{const a=e,{__scopeAlertDialog:r}=a,t=c(a,["__scopeAlertDialog"]),{cancelRef:l}=re(me,r),i=Z(r),d=h(s,l);return u.jsx(b,n(o(o({},i),t),{ref:d}))});ue.displayName=me;var pe=({contentRef:e})=>{const s=`\`${se}\` requires a description for the component to be accessible for screen reader users.\n\nYou can add a description to the \`${se}\` by passing a \`${ne}\` component as a child, which also benefits sighted users by adding visible context to the dialog.\n\nAlternatively, you can use your own component as a description by assigning it an \`id\` and passing the same value to the \`aria-describedby\` prop in \`${se}\`. If the description is confusing or duplicative for sighted users, you can use the \`@radix-ui/react-visually-hidden\` primitive as a wrapper around your description component.\n\nFor more information, see https://radix-ui.com/primitives/docs/components/alert-dialog`;return D.useEffect(()=>{var a;document.getElementById(null==(a=e.current)?void 0:a.getAttribute("aria-describedby"))||console.warn(s)},[s,e]),null},fe=ee,he=le,xe=de,ge=ue,ve=oe,ye=ce;const je=J,Ne=X,we=D.forwardRef((e,s)=>{var a=e,{className:r}=a,t=c(a,["className"]);return u.jsx(fe,n(o({className:W("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",r)},t),{ref:s}))});we.displayName=fe.displayName;const be=D.forwardRef((e,s)=>{var a=e,{className:r}=a,t=c(a,["className"]);return u.jsxs(Ne,{children:[u.jsx(we,{}),u.jsx(he,o({ref:s,className:W("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",r)},t))]})});be.displayName=he.displayName;const _e=e=>{var s=e,{className:a}=s,r=c(s,["className"]);return u.jsx("div",o({className:W("flex flex-col space-y-2 text-center sm:text-left",a)},r))};_e.displayName="AlertDialogHeader";const Ae=e=>{var s=e,{className:a}=s,r=c(s,["className"]);return u.jsx("div",o({className:W("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",a)},r))};Ae.displayName="AlertDialogFooter";const De=D.forwardRef((e,s)=>{var a=e,{className:r}=a,t=c(a,["className"]);return u.jsx(ve,o({ref:s,className:W("text-lg font-semibold",r)},t))});De.displayName=ve.displayName;const ke=D.forwardRef((e,s)=>{var a=e,{className:r}=a,t=c(a,["className"]);return u.jsx(ye,o({ref:s,className:W("text-sm text-muted-foreground",r)},t))});ke.displayName=ye.displayName;const Pe=D.forwardRef((e,s)=>{var a=e,{className:r}=a,t=c(a,["className"]);return u.jsx(xe,o({ref:s,className:W(S(),r)},t))});Pe.displayName=xe.displayName;const Se=D.forwardRef((e,s)=>{var a=e,{className:r}=a,t=c(a,["className"]);return u.jsx(ge,o({ref:s,className:W(S({variant:"outline"}),"mt-2 sm:mt-0",r)},t))});Se.displayName=ge.displayName;const Re=e=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)&&e.length<=254,Ee=()=>{const[e,s]=D.useState(!1),[a,r]=D.useState({email:"",password:""}),[t,l]=D.useState(!1),[i,c]=D.useState({}),[m,p]=D.useState({}),[f,h]=D.useState(0),[x,g]=D.useState(null),[v,y]=D.useState([]),[j,N]=D.useState(!1),[w,b]=D.useState(!1),[_,A]=D.useState(!1),[S,W]=D.useState(""),[M,Q]=D.useState(!1),[Z,J]=D.useState(null),{toast:X}=B(),ee=k(),se=(e,s)=>{if(r(a=>n(o({},a),{[e]:s})),v.length>0&&y([]),"email"===e&&(s&&!Re(s)?c(e=>n(o({},e),{email:"Please enter a valid email address"})):c(e=>n(o({},e),{email:""}))),"password"===e){const e=(e=>{let s=0;const a=[];e.length>=8?s+=1:a.push("Use at least 8 characters"),/[A-Z]/.test(e)?s+=1:a.push("Add uppercase letter"),/[a-z]/.test(e)?s+=1:a.push("Add lowercase letter"),/\d/.test(e)?s+=1:a.push("Add number"),/[!@#$%^&*()_+\-=[\]{};':"\\|,.<>?/]/.test(e)?s+=1:a.push("Add special character"),e.length>=12&&(s+=1);const r=[{score:0,feedback:"Very weak",color:"text-red-500"},{score:2,feedback:"Weak",color:"text-orange-500"},{score:4,feedback:"Fair",color:"text-yellow-500"},{score:5,feedback:"Good",color:"text-blue-500"},{score:6,feedback:"Strong",color:"text-green-500"}],t=r[Math.min(s,r.length-1)];return{score:s,feedback:a.length>0?a.join(", "):t.feedback,color:t.color}})(s);J(e),s&&e.score<3?c(s=>n(o({},s),{password:`Password is too weak. ${e.feedback}`})):c(e=>n(o({},e),{password:""}))}};return u.jsx("div",{className:"min-h-screen bg-gradient-subtle flex items-center justify-center p-4",children:u.jsxs("div",{className:"w-full max-w-md space-y-6",children:[u.jsx("div",{className:"text-center",children:u.jsxs(P,{to:"/",className:"inline-flex items-center space-x-2 mb-6",children:[u.jsx("img",{src:"/logo.png",alt:"Novaqy logo",className:"h-12 w-auto object-contain",loading:"eager",decoding:"async"}),u.jsx("span",{className:"text-2xl font-bold",children:"Novaqy"})]})}),u.jsxs(C,{children:[u.jsxs(q,{className:"text-center",children:[u.jsx(F,{className:"text-2xl",children:"Secure Log In"}),u.jsx(I,{children:"Access your account with enhanced security"})]}),u.jsxs($,{className:"space-y-6",children:[u.jsxs(z,{children:[u.jsx(V,{className:"h-4 w-4"}),u.jsx(T,{children:"Your login is protected with advanced security measures including rate limiting and CSRF protection."})]}),v.length>0&&u.jsxs(z,{variant:"destructive",children:[u.jsx(G,{className:"h-4 w-4"}),u.jsx(T,{children:u.jsx("ul",{className:"list-disc list-inside space-y-1",children:v.map((e,s)=>u.jsx("li",{children:e},s))})})]}),j&&u.jsxs(z,{children:[u.jsx(G,{className:"h-4 w-4"}),u.jsxs(T,{className:"flex items-center justify-between",children:[u.jsx("span",{children:"Didn't receive the verification email?"}),u.jsx(R,{variant:"outline",size:"sm",onClick:()=>d(null,null,function*(){if(a.email){b(!0);try{const{error:e}=yield Y.auth.resend({type:"signup",email:a.email});if(e)throw e;X({title:"Verification email sent",description:"Please check your inbox for the verification email."}),N(!1)}catch(e){console.error("Resend error:",e);X({title:"Failed to resend",description:e.message||"Failed to resend verification email. Please try again.",variant:"destructive"})}finally{b(!1)}}else X({title:"Email required",description:"Please enter your email address first.",variant:"destructive"})}),disabled:w,className:"ml-2",children:w?"Sending...":"Resend Email"})]})]}),u.jsxs("div",{className:"relative",children:[u.jsx(L,{}),u.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:u.jsx("span",{className:"bg-background px-4 text-sm text-muted-foreground",children:"OR"})})]}),u.jsxs("form",{onSubmit:e=>d(null,null,function*(){e.preventDefault(),y([]);const s={};if(a.email?Re(a.email)||(s.email="Please enter a valid email address"):s.email="Email is required",a.password?Z&&Z.score<3&&(s.password=`Password is too weak. ${Z.feedback}`):s.password="Password is required",c(s),Object.keys(s).length>0)y(["Please correct the errors above"]);else{l(!0);try{const{data:e,error:s}=yield Y.auth.signInWithPassword({email:a.email,password:a.password});if(s)throw s;e.user&&(yield U.trackActivity("user_login",{email:a.email,method:"email"}),X({title:"Login successful",description:"Welcome back to Novaqy!"}),ee("/dashboard"))}catch(r){console.error("Login error:",r);let e="Invalid email or password",s=!1;const a=r;a.message&&(a.message.includes("Email not confirmed")||a.message.includes("email_not_confirmed")?(e="Please confirm your email address before signing in. Check your inbox for the verification email.",s=!0):e=a.message.includes("Invalid login credentials")||a.message.includes("invalid_credentials")?"Invalid email or password. Please check your credentials and try again.":a.message.includes("Too many requests")||a.message.includes("rate_limit")?"Too many login attempts. Please wait a few minutes before trying again.":a.message.includes("User not found")||a.message.includes("user_not_found")?"No account found with this email address. Please sign up first.":a.message.includes("Email link is invalid")||a.message.includes("invalid_email")?"Invalid email format. Please enter a valid email address.":a.message),y([e]),N(s),X({title:"Login failed",description:e,variant:"destructive"})}finally{l(!1)}}}),className:"space-y-4",children:[u.jsxs("div",{className:"space-y-2",children:[u.jsx(O,{htmlFor:"email",children:"Email"}),u.jsx(E,{id:"email",type:"email",value:a.email,onChange:e=>se("email",e.target.value),placeholder:"Enter your email",required:!0,maxLength:254,autoComplete:"email",className:i.email?"border-red-500":""}),i.email&&u.jsx("p",{className:"text-sm text-red-500",children:i.email})]}),u.jsxs("div",{className:"space-y-2",children:[u.jsx(O,{htmlFor:"password",children:"Password"}),u.jsxs("div",{className:"relative",children:[u.jsx(E,{id:"password",type:e?"text":"password",value:a.password,onChange:e=>se("password",e.target.value),placeholder:"Enter your password",required:!0,maxLength:128,autoComplete:"current-password",className:i.password?"border-red-500":""}),u.jsx(R,{type:"button",variant:"ghost",size:"sm",className:"absolute right-0 top-0 h-full px-3 hover:bg-transparent",onClick:()=>s(!e),disabled:t,children:e?u.jsx(H,{className:"h-4 w-4"}):u.jsx(K,{className:"h-4 w-4"})})]}),Z&&a.password&&u.jsxs("div",{className:"flex items-center space-x-2",children:[u.jsx("div",{className:"flex-1 bg-gray-200 rounded-full h-2",children:u.jsx("div",{className:"h-2 rounded-full transition-all duration-300 "+(Z.score<=2?"bg-red-500 w-1/3":Z.score<=4?"bg-yellow-500 w-2/3":Z.score<=5?"bg-blue-500 w-4/5":"bg-green-500 w-full")})}),u.jsx("span",{className:`text-sm ${Z.color}`,children:Z.feedback})]}),i.password&&u.jsx("p",{className:"text-sm text-red-500",children:i.password})]}),u.jsx("div",{className:"flex items-center justify-between",children:u.jsx(R,{variant:"link",className:"p-0 h-auto text-sm text-primary hover:underline",type:"button",onClick:()=>A(!0),disabled:t,children:"Forgot password?"})}),u.jsx(R,{type:"submit",className:"w-full",disabled:t,children:t?"Signing In...":"Sign In Securely"})]}),u.jsxs(z,{children:[u.jsx(G,{className:"h-4 w-4"}),u.jsxs(T,{children:[u.jsx("strong",{children:"Note:"})," Social authentication requires configuration in Supabase Dashboard. Email authentication is ready to use."]})]}),u.jsxs("div",{className:"text-center text-sm",children:["Don't have an account?"," ",u.jsx(P,{to:"/signup",className:"text-primary hover:underline font-medium",children:"Create your account"})]})]})]}),u.jsx(je,{open:_,onOpenChange:A,children:u.jsxs(be,{children:[u.jsxs(_e,{children:[u.jsx(De,{children:"Reset Your Password"}),u.jsx(ke,{children:"Enter your email address and we'll send you a link to reset your password."})]}),u.jsx("div",{className:"space-y-4 py-4",children:u.jsxs("div",{className:"space-y-2",children:[u.jsx(O,{htmlFor:"resetEmail",children:"Email Address"}),u.jsx(E,{id:"resetEmail",type:"email",value:S,onChange:e=>W(e.target.value),placeholder:"Enter your email address",required:!0})]})}),u.jsxs(Ae,{children:[u.jsx(Se,{disabled:M,children:"Cancel"}),u.jsx(Pe,{onClick:()=>d(null,null,function*(){if(S)if(/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e=S)&&e.length<=254){var e;Q(!0);try{const{error:e}=yield Y.auth.resetPasswordForEmail(S,{redirectTo:`${window.location.origin}/reset-password`});if(e)throw e;X({title:"Password reset email sent",description:"Please check your inbox for password reset instructions."}),A(!1),W("")}catch(s){console.error("Password reset error:",s);X({title:"Failed to send reset email",description:s.message||"Failed to send password reset email. Please try again.",variant:"destructive"})}finally{Q(!1)}}else X({title:"Invalid email",description:"Please enter a valid email address.",variant:"destructive"});else X({title:"Email required",description:"Please enter your email address.",variant:"destructive"})}),disabled:M||!S,children:M?"Sending...":"Send Reset Link"})]})]})}),u.jsx("div",{className:"text-center text-xs text-muted-foreground",children:u.jsxs("p",{children:["By signing in, you agree to our"," ",u.jsx(P,{to:"/terms",className:"hover:underline",children:"Terms of Service"})," ","and"," ",u.jsx(P,{to:"/cookies",className:"hover:underline",children:"Privacy Policy"})]})})]})})};export{Ee as default};
