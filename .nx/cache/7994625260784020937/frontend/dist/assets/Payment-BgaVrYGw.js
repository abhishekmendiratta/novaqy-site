var e=Object.defineProperty,s=Object.defineProperties,a=Object.getOwnPropertyDescriptors,r=Object.getOwnPropertySymbols,t=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable,n=(s,a,r)=>a in s?e(s,a,{enumerable:!0,configurable:!0,writable:!0,value:r}):s[a]=r,l=(e,s)=>{for(var a in s||(s={}))t.call(s,a)&&n(e,a,s[a]);if(r)for(var a of r(s))i.call(s,a)&&n(e,a,s[a]);return e},c=(e,r)=>s(e,a(r));import{j as o}from"./ui-vendor-CD6GsE3j.js";import{u as d,k as m,a as p}from"./react-vendor-tk5Uqt6k.js";import{H as u,F as h}from"./Footer-7rwmqgO2.js";import{I as x,B as y}from"./input-CMCPGH7W.js";import{L as g}from"./label-DfKMYoEj.js";import{C as v,b as j,d as f,a as N,e as b}from"./card-CylQdLZn.js";import{C as P}from"./checkbox-B6W2aaBM.js";import{B as w}from"./badge-D4v7deY6.js";import{a as C,u as $,b as S}from"./index-yDwtLQoE.js";import{S as k,e as _}from"./enc-hex-6PzZXuws.js";import{p as T}from"./supabaseService-DdYkWjT-.js";import{e as F,b as E,L as A,y as D}from"./utils-vendor-cIoDbW7Q.js";import"./separator-DUCCQS5n.js";import"./auth-vendor-CP-4ZW6D.js";import"./query-vendor-D3F-YppS.js";const O=()=>{var e,s;const a=d(),r=m(),{toast:t}=C(),{currency:i,convertFromUSD:n,format:O}=$(),q=(null==(e=a.state)?void 0:e.selectedPlan)||"Essential Care",U=(null==(s=a.state)?void 0:s.planType)||"personal",I={"Essential Care":{name:"Essential Care",price:99,period:"year",features:["3 on-demand support sessions per year (remote)","PC health check & optimization (1× per year)","Basic antivirus setup (BYOL – bring your own license or trial)","Email support during business hours"]},"Advanced Care":{name:"Advanced Care",price:149,period:"year",features:["Unlimited remote support sessions (1 device)","Antivirus license included (1 device, 1 year)","Monthly PC tune-up & malware scans","Printer, email, and software troubleshooting","Priority support (faster response)"]},"Premium Care":{name:"Premium Care",price:249,period:"year",features:["Unlimited remote support for up to 3 devices (PC, tablet, phone)","Quarterly PC optimization + patching","Assistance with apps, online payments, and cloud storage","Priority support (8:30AM - 8:30PM EST)"]},"Family / Elite Care":{name:"Family Care",price:449,period:"year",features:["Unlimited support for up to 5 devices","Full software setup (Zoom, email, cloud, banking apps)","Smart home/IoT troubleshooting (Wi-Fi, Alexa, TVs, routers)","Priority support with toll-free number (8:30AM - 8:30PM EST)"]}},z=I[q]||I["Essential Care"],[B,M]=p.useState({firstName:"",lastName:"",email:"",phone:"",address:"",city:"",state:"",zipCode:"",agreeToPolicies:!1,agreeToServiceDelivery:!1}),[L,R]=p.useState(!1);return o.jsxs("div",{className:"min-h-screen bg-background",children:[o.jsx(u,{}),o.jsx("div",{className:"container py-8",children:o.jsxs("div",{className:"max-w-6xl mx-auto",children:[o.jsxs("div",{className:"text-center mb-8",children:[o.jsx("h1",{className:"text-4xl font-bold mb-4",children:"Complete Your Purchase"}),o.jsx("p",{className:"text-xl text-muted-foreground",children:"Secure checkout for your Novaqy subscription"})]}),o.jsxs("div",{className:"grid lg:grid-cols-3 gap-8",children:[o.jsx("div",{className:"lg:col-span-1",children:o.jsxs(v,{className:"sticky top-24",children:[o.jsx(j,{children:o.jsxs(f,{className:"flex items-center gap-2",children:[o.jsx(F,{className:"w-5 h-5 text-green-600"}),"Order Summary"]})}),o.jsxs(N,{className:"space-y-4",children:[o.jsxs("div",{className:"border rounded-lg p-4 bg-muted/50",children:[o.jsxs("div",{className:"flex justify-between items-start mb-3",children:[o.jsxs("div",{children:[o.jsx("h3",{className:"font-semibold text-lg",children:z.name}),o.jsx(w,{variant:"secondary",className:"mt-1",children:"personal"===U?"Personal Plan":"Business Plan"})]}),o.jsxs("div",{className:"text-right",children:[o.jsx("div",{className:"text-2xl font-bold",children:O(z.price)}),o.jsxs("div",{className:"text-sm text-muted-foreground",children:["per ",z.period," (",i,")"]})]})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx("h4",{className:"font-medium text-sm",children:"What's included:"}),o.jsx("ul",{className:"space-y-1",children:z.features.map((e,s)=>o.jsxs("li",{className:"text-sm text-muted-foreground flex items-start gap-2",children:[o.jsx(F,{className:"w-3 h-3 text-green-600 mt-0.5 flex-shrink-0"}),e]},`${z.name}-feature-${s}`))})]})]}),o.jsx("div",{className:"space-y-2",children:o.jsxs("div",{className:"flex justify-between text-lg font-semibold",children:[o.jsx("span",{children:"Total"}),o.jsx("span",{children:O(z.price)})]})}),o.jsxs("div",{className:"flex items-center justify-center gap-4 pt-4 border-t",children:[o.jsxs("div",{className:"flex items-center gap-1 text-sm text-muted-foreground",children:[o.jsx(E,{className:"w-4 h-4"}),"SSL Secured"]}),o.jsxs("div",{className:"flex items-center gap-1 text-sm text-muted-foreground",children:[o.jsx(A,{className:"w-4 h-4"}),"256-bit Encryption"]})]})]})]})}),o.jsx("div",{className:"lg:col-span-2",children:o.jsxs("form",{onSubmit:e=>{return s=null,a=null,r=function*(){if(e.preventDefault(),yield S.trackPaymentAttempt({plan_name:z.name,plan_type:U,amount:n(z.price),currency:i,user_email:B.email,user_name:`${B.firstName} ${B.lastName}`}),["firstName","lastName","email","phone","address","city","state","zipCode"].filter(e=>!B[e]).length>0)t({title:"Missing Information",description:"Please fill in all required fields.",variant:"destructive"});else if(B.agreeToPolicies&&B.agreeToServiceDelivery){R(!0);try{const e="TXN"+Date.now()+Math.random().toString(36).substr(2,9),s="xhkupK",a="yUmEyYcZ3xI1BuXdSvmnz6RU1AP1mam2",r=n(z.price),l=r.toFixed(2),c=z.name,o=B.firstName,d=B.email,m=B.phone.replace(/\D/g,""),p=k(`${s}|${e}|${l}|${c}|${o}|${d}|||||||||||${a}`).toString(_),u={user_id:null,transaction_id:e,amount:r,currency:i,status:"pending",payment_method:"payu",plan_name:z.name,plan_type:U,payu_response:{},payment_gateway:"payu",gateway_transaction_id:null};if(!(yield T.createPayment(u)))return yield S.trackPaymentFailure("Database save failed",{transaction_id:e,amount:z.price}),t({title:"Database Error",description:"Failed to save payment data. Please try again.",variant:"destructive"}),void R(!1);yield S.trackActivity("payment_initiated",{transaction_id:e,amount:r,plan_name:z.name,gateway:"payu"});const h=document.createElement("form");h.method="POST",h.action="https://secure.payu.in/_payment";const x=`${window.location.origin}/payment/success?txnid=${e}`,y=`${window.location.origin}/payment/failed?txnid=${e}`,g={key:s,txnid:e,amount:l,currency:i,productinfo:c,firstname:o,email:d,phone:m,surl:x,furl:y,hash:p,service_provider:"payu_paisa"};Object.entries(g).forEach(([e,s])=>{const a=document.createElement("input");a.type="hidden",a.name=e,a.value=s,h.appendChild(a)}),document.body.appendChild(h),h.submit()}catch(s){console.error("Payment initiation error:",s),yield S.trackPaymentFailure("Payment initiation error",{error:s instanceof Error?s.message:"Unknown error",plan_name:z.name,amount:n(z.price)}),t({title:"Payment Error",description:"There was an error initiating payment. Please try again.",variant:"destructive"}),R(!1)}}else t({title:"Agreement Required",description:"Please agree to both the policies and service delivery terms.",variant:"destructive"})},new Promise((t,i)=>{var n=s=>{try{c(r.next(s))}catch(e){i(e)}},l=s=>{try{c(r.throw(s))}catch(e){i(e)}},c=e=>e.done?t(e.value):Promise.resolve(e.value).then(n,l);c((r=r.apply(s,a)).next())});var s,a,r},className:"space-y-6",children:[o.jsxs(v,{children:[o.jsxs(j,{children:[o.jsx(f,{children:"Billing Information"}),o.jsx(b,{children:"Please provide your billing details"})]}),o.jsxs(N,{className:"space-y-4",children:[o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxs("div",{className:"space-y-2",children:[o.jsx(g,{htmlFor:"firstName",children:"First Name *"}),o.jsx(x,{id:"firstName",value:B.firstName,onChange:e=>M(s=>c(l({},s),{firstName:e.target.value})),required:!0})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx(g,{htmlFor:"lastName",children:"Last Name *"}),o.jsx(x,{id:"lastName",value:B.lastName,onChange:e=>M(s=>c(l({},s),{lastName:e.target.value})),required:!0})]})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx(g,{htmlFor:"email",children:"Email Address *"}),o.jsx(x,{id:"email",type:"email",value:B.email,onChange:e=>M(s=>c(l({},s),{email:e.target.value})),required:!0})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx(g,{htmlFor:"phone",children:"Phone Number *"}),o.jsx(x,{id:"phone",type:"tel",value:B.phone,onChange:e=>{const s=(e=>{const s=e.replace(/\D/g,"");if(0===s.length)return"";if(s.startsWith("1")&&11===s.length)return`+${s.slice(0,1)} (${s.slice(1,4)}) ${s.slice(4,7)}-${s.slice(7,11)}`;if(10===s.length)return`(${s.slice(0,3)}) ${s.slice(3,6)}-${s.slice(6,10)}`;if(s.length>=11){const e=s.slice(0,s.length-10),a=s.slice(-10);return`+${e} (${a.slice(0,3)}) ${a.slice(3,6)}-${a.slice(6,10)}`}return s.length<=3?s:s.length<=6?`(${s.slice(0,3)}) ${s.slice(3)}`:`(${s.slice(0,3)}) ${s.slice(3,6)}-${s.slice(6)}`})(e.target.value);M(e=>c(l({},e),{phone:s}))},placeholder:"(123) 456-7890 or +1 (123) 456-7890",required:!0})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx(g,{htmlFor:"address",children:"Street Address *"}),o.jsx(x,{id:"address",value:B.address,onChange:e=>M(s=>c(l({},s),{address:e.target.value})),required:!0})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxs("div",{className:"space-y-2",children:[o.jsx(g,{htmlFor:"city",children:"City *"}),o.jsx(x,{id:"city",value:B.city,onChange:e=>M(s=>c(l({},s),{city:e.target.value})),required:!0})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx(g,{htmlFor:"state",children:"State *"}),o.jsx(x,{id:"state",value:B.state,onChange:e=>M(s=>c(l({},s),{state:e.target.value})),required:!0})]})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx(g,{htmlFor:"zipCode",children:"ZIP Code *"}),o.jsx(x,{id:"zipCode",value:B.zipCode,onChange:e=>M(s=>c(l({},s),{zipCode:e.target.value})),required:!0})]})]})]}),o.jsxs(v,{children:[o.jsxs(j,{children:[o.jsxs(f,{className:"flex items-center gap-2",children:[o.jsx(D,{className:"w-5 h-5"}),"Payment Information"]}),o.jsx(b,{children:"You will be redirected to PayU's secure payment gateway to complete your payment"})]}),o.jsx(N,{children:o.jsxs("div",{className:"text-center py-6",children:[o.jsx(E,{className:"w-12 h-12 text-green-600 mx-auto mb-4"}),o.jsx("p",{className:"text-muted-foreground",children:"Your payment information will be securely processed by PayU, a trusted payment gateway."})]})})]}),o.jsxs(v,{children:[o.jsxs(j,{children:[o.jsx(f,{children:"Terms & Agreements"}),o.jsx(b,{children:"Please review and agree to the following terms"})]}),o.jsxs(N,{className:"space-y-4",children:[o.jsxs("div",{className:"flex items-start space-x-2",children:[o.jsx(P,{id:"policies",checked:B.agreeToPolicies,onCheckedChange:e=>M(s=>c(l({},s),{agreeToPolicies:e}))}),o.jsxs(g,{htmlFor:"policies",className:"text-sm leading-relaxed",children:["I agree to the"," ",o.jsx("a",{href:"/terms",target:"_blank",className:"text-primary hover:underline",children:"Terms of Service"}),","," ",o.jsx("a",{href:"/return-refund",target:"_blank",className:"text-primary hover:underline",children:"Return & Refund Policy"}),","," ",o.jsx("a",{href:"/remote-disclaimer",target:"_blank",className:"text-primary hover:underline",children:"Remote Support Disclaimer"}),", and"," ",o.jsx("a",{href:"/end-user-agreement",target:"_blank",className:"text-primary hover:underline",children:"End User License Agreement"})," ","*"]})]}),o.jsxs("div",{className:"flex items-start space-x-2",children:[o.jsx(P,{id:"service-delivery",checked:B.agreeToServiceDelivery,onCheckedChange:e=>M(s=>c(l({},s),{agreeToServiceDelivery:e}))}),o.jsxs(g,{htmlFor:"service-delivery",className:"text-sm leading-relaxed",children:["I agree to electronic service delivery and acknowledge that software licenses will be delivered via email within 24-48 hours, and I understand the"," ",o.jsx("a",{href:"/shipping",target:"_blank",className:"text-primary hover:underline",children:"Shipping Policy"})," ","for any physical items *"]})]})]})]}),o.jsxs("div",{className:"flex gap-4",children:[o.jsx(y,{type:"button",variant:"outline",onClick:()=>r("/pricing"),className:"flex-1",children:"Back to Pricing"}),o.jsx(y,{type:"submit",disabled:L||!B.agreeToPolicies||!B.agreeToServiceDelivery,className:"flex-1 transition-all duration-200 "+(B.agreeToPolicies&&B.agreeToServiceDelivery?"bg-green-600 hover:bg-green-700 text-white shadow-lg scale-105":"bg-gray-400 cursor-not-allowed"),children:L?"Redirecting to PayU...":`Proceed to Payment - ${O(z.price)}`})]})]})})]})]})}),o.jsx(h,{})]})};export{O as default};
