var e=Object.defineProperty,s=Object.defineProperties,a=Object.getOwnPropertyDescriptors,t=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,l=Object.prototype.propertyIsEnumerable,i=(s,a,t)=>a in s?e(s,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[a]=t,o=(e,s)=>{for(var a in s||(s={}))r.call(s,a)&&i(e,a,s[a]);if(t)for(var a of t(s))l.call(s,a)&&i(e,a,s[a]);return e},n=(e,t)=>s(e,a(t)),c=(e,s)=>{var a={};for(var i in e)r.call(e,i)&&s.indexOf(i)<0&&(a[i]=e[i]);if(null!=e&&t)for(var i of t(e))s.indexOf(i)<0&&l.call(e,i)&&(a[i]=e[i]);return a},d=(e,s,a)=>new Promise((t,r)=>{var l=e=>{try{o(a.next(e))}catch(s){r(s)}},i=e=>{try{o(a.throw(e))}catch(s){r(s)}},o=e=>e.done?t(e.value):Promise.resolve(e.value).then(l,i);o((a=a.apply(e,s)).next())});import{o as m,j as u,p,q as h,u as f,W as x,c as g,r as v,e as j,l as y,T as w,s as N,t as b,O as A,v as _}from"./ui-vendor-CD6GsE3j.js";import{a as k,k as D,L as P}from"./react-vendor-tk5Uqt6k.js";import{b as C,B as S,I as R}from"./input-CysZIFLO.js";import{L as O}from"./label-nOSSazfq.js";import{C as E,b as F,d as q,e as I,a as z}from"./card-BXNOJQcw.js";import{S as $}from"./separator-DaMGMxzJ.js";import{A as L,a as M}from"./alert-CH7wTShZ.js";import{c as T,a as B,s as H,b as W}from"./index-D9MfjVgY.js";import{b as V,l as Y,E as G,m as U}from"./utils-vendor-cIoDbW7Q.js";import"./auth-vendor-CP-4ZW6D.js";import"./query-vendor-D3F-YppS.js";var K="AlertDialog",[Q]=g(K,[m]),Z=m(),J=e=>{const s=e,{__scopeAlertDialog:a}=s,t=c(s,["__scopeAlertDialog"]),r=Z(a);return u.jsx(p,n(o(o({},r),t),{modal:!0}))};J.displayName=K;k.forwardRef((e,s)=>{const a=e,{__scopeAlertDialog:t}=a,r=c(a,["__scopeAlertDialog"]),l=Z(t);return u.jsx(_,n(o(o({},l),r),{ref:s}))}).displayName="AlertDialogTrigger";var X=e=>{const s=e,{__scopeAlertDialog:a}=s,t=c(s,["__scopeAlertDialog"]),r=Z(a);return u.jsx(h,o(o({},r),t))};X.displayName="AlertDialogPortal";var ee=k.forwardRef((e,s)=>{const a=e,{__scopeAlertDialog:t}=a,r=c(a,["__scopeAlertDialog"]),l=Z(t);return u.jsx(A,n(o(o({},l),r),{ref:s}))});ee.displayName="AlertDialogOverlay";var se="AlertDialogContent",[ae,te]=Q(se),re=y("AlertDialogContent"),le=k.forwardRef((e,s)=>{const a=e,{__scopeAlertDialog:t,children:r}=a,l=c(a,["__scopeAlertDialog","children"]),i=Z(t),d=k.useRef(null),m=f(s,d),p=k.useRef(null);return u.jsx(x,{contentName:se,titleName:ie,docsSlug:"alert-dialog",children:u.jsx(ae,{scope:t,cancelRef:p,children:u.jsxs(v,n(o(o({role:"alertdialog"},i),l),{ref:m,onOpenAutoFocus:j(l.onOpenAutoFocus,e=>{var s;e.preventDefault(),null==(s=p.current)||s.focus({preventScroll:!0})}),onPointerDownOutside:e=>e.preventDefault(),onInteractOutside:e=>e.preventDefault(),children:[u.jsx(re,{children:r}),u.jsx(pe,{contentRef:d})]}))})})});le.displayName=se;var ie="AlertDialogTitle",oe=k.forwardRef((e,s)=>{const a=e,{__scopeAlertDialog:t}=a,r=c(a,["__scopeAlertDialog"]),l=Z(t);return u.jsx(w,n(o(o({},l),r),{ref:s}))});oe.displayName=ie;var ne="AlertDialogDescription",ce=k.forwardRef((e,s)=>{const a=e,{__scopeAlertDialog:t}=a,r=c(a,["__scopeAlertDialog"]),l=Z(t);return u.jsx(N,n(o(o({},l),r),{ref:s}))});ce.displayName=ne;var de=k.forwardRef((e,s)=>{const a=e,{__scopeAlertDialog:t}=a,r=c(a,["__scopeAlertDialog"]),l=Z(t);return u.jsx(b,n(o(o({},l),r),{ref:s}))});de.displayName="AlertDialogAction";var me="AlertDialogCancel",ue=k.forwardRef((e,s)=>{const a=e,{__scopeAlertDialog:t}=a,r=c(a,["__scopeAlertDialog"]),{cancelRef:l}=te(me,t),i=Z(t),d=f(s,l);return u.jsx(b,n(o(o({},i),r),{ref:d}))});ue.displayName=me;var pe=({contentRef:e})=>{const s=`\`${se}\` requires a description for the component to be accessible for screen reader users.\n\nYou can add a description to the \`${se}\` by passing a \`${ne}\` component as a child, which also benefits sighted users by adding visible context to the dialog.\n\nAlternatively, you can use your own component as a description by assigning it an \`id\` and passing the same value to the \`aria-describedby\` prop in \`${se}\`. If the description is confusing or duplicative for sighted users, you can use the \`@radix-ui/react-visually-hidden\` primitive as a wrapper around your description component.\n\nFor more information, see https://radix-ui.com/primitives/docs/components/alert-dialog`;return k.useEffect(()=>{var a;document.getElementById(null==(a=e.current)?void 0:a.getAttribute("aria-describedby"))||console.warn(s)},[s,e]),null},he=ee,fe=le,xe=de,ge=ue,ve=oe,je=ce;const ye=J,we=X,Ne=k.forwardRef((e,s)=>{var a=e,{className:t}=a,r=c(a,["className"]);return u.jsx(he,n(o({className:T("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t)},r),{ref:s}))});Ne.displayName=he.displayName;const be=k.forwardRef((e,s)=>{var a=e,{className:t}=a,r=c(a,["className"]);return u.jsxs(we,{children:[u.jsx(Ne,{}),u.jsx(fe,o({ref:s,className:T("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t)},r))]})});be.displayName=fe.displayName;const Ae=e=>{var s=e,{className:a}=s,t=c(s,["className"]);return u.jsx("div",o({className:T("flex flex-col space-y-2 text-center sm:text-left",a)},t))};Ae.displayName="AlertDialogHeader";const _e=e=>{var s=e,{className:a}=s,t=c(s,["className"]);return u.jsx("div",o({className:T("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",a)},t))};_e.displayName="AlertDialogFooter";const ke=k.forwardRef((e,s)=>{var a=e,{className:t}=a,r=c(a,["className"]);return u.jsx(ve,o({ref:s,className:T("text-lg font-semibold",t)},r))});ke.displayName=ve.displayName;const De=k.forwardRef((e,s)=>{var a=e,{className:t}=a,r=c(a,["className"]);return u.jsx(je,o({ref:s,className:T("text-sm text-muted-foreground",t)},r))});De.displayName=je.displayName;const Pe=k.forwardRef((e,s)=>{var a=e,{className:t}=a,r=c(a,["className"]);return u.jsx(xe,o({ref:s,className:T(C(),t)},r))});Pe.displayName=xe.displayName;const Ce=k.forwardRef((e,s)=>{var a=e,{className:t}=a,r=c(a,["className"]);return u.jsx(ge,o({ref:s,className:T(C({variant:"outline"}),"mt-2 sm:mt-0",t)},r))});Ce.displayName=ge.displayName;const Se=e=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)&&e.length<=254,Re=()=>{const[e,s]=k.useState(!1),[a,t]=k.useState({email:"",password:""}),[r,l]=k.useState(!1),[i,c]=k.useState({}),[m,p]=k.useState({}),[h,f]=k.useState(0),[x,g]=k.useState(null),[v,j]=k.useState([]),[y,w]=k.useState(!1),[N,b]=k.useState(!1),[A,_]=k.useState(!1),[C,T]=k.useState(""),[K,Q]=k.useState(!1),[Z,J]=k.useState(null),{toast:X}=B(),ee=D(),se=e=>d(null,null,function*(){try{l(!0);const{error:s}=yield H.auth.signInWithOAuth({provider:e,options:{redirectTo:`${window.location.origin}/dashboard`}});if(s)throw s;yield W.trackActivity("social_auth_attempt",{provider:e,method:"login"})}catch(s){console.error(`${e} auth error:`,s),X({title:"Authentication failed",description:`Failed to sign in with ${e}. Please try again.`,variant:"destructive"})}finally{l(!1)}}),ae=(e,s)=>{if(t(a=>n(o({},a),{[e]:s})),v.length>0&&j([]),"email"===e&&(s&&!Se(s)?c(e=>n(o({},e),{email:"Please enter a valid email address"})):c(e=>n(o({},e),{email:""}))),"password"===e){const e=(e=>{let s=0;const a=[];e.length>=8?s+=1:a.push("Use at least 8 characters"),/[A-Z]/.test(e)?s+=1:a.push("Add uppercase letter"),/[a-z]/.test(e)?s+=1:a.push("Add lowercase letter"),/\d/.test(e)?s+=1:a.push("Add number"),/[!@#$%^&*()_+\-=[\]{};':"\\|,.<>?/]/.test(e)?s+=1:a.push("Add special character"),e.length>=12&&(s+=1);const t=[{score:0,feedback:"Very weak",color:"text-red-500"},{score:2,feedback:"Weak",color:"text-orange-500"},{score:4,feedback:"Fair",color:"text-yellow-500"},{score:5,feedback:"Good",color:"text-blue-500"},{score:6,feedback:"Strong",color:"text-green-500"}],r=t[Math.min(s,t.length-1)];return{score:s,feedback:a.length>0?a.join(", "):r.feedback,color:r.color}})(s);J(e),s&&e.score<3?c(s=>n(o({},s),{password:"Password is too weak. "+e.feedback})):c(e=>n(o({},e),{password:""}))}};return u.jsx("div",{className:"min-h-screen bg-gradient-subtle flex items-center justify-center p-4",children:u.jsxs("div",{className:"w-full max-w-md space-y-6",children:[u.jsx("div",{className:"text-center",children:u.jsxs(P,{to:"/",className:"inline-flex items-center space-x-2 mb-6",children:[u.jsx("img",{src:"/logo.png",alt:"Novaqy logo",className:"h-12 w-auto object-contain",loading:"eager",decoding:"async"}),u.jsx("span",{className:"text-2xl font-bold",children:"Novaqy"})]})}),u.jsxs(E,{children:[u.jsxs(F,{className:"text-center",children:[u.jsx(q,{className:"text-2xl",children:"Secure Log In"}),u.jsx(I,{children:"Access your account with enhanced security"})]}),u.jsxs(z,{className:"space-y-6",children:[u.jsxs(L,{children:[u.jsx(V,{className:"h-4 w-4"}),u.jsx(M,{children:"Your login is protected with advanced security measures including rate limiting and CSRF protection."})]}),v.length>0&&u.jsxs(L,{variant:"destructive",children:[u.jsx(Y,{className:"h-4 w-4"}),u.jsx(M,{children:u.jsx("ul",{className:"list-disc list-inside space-y-1",children:v.map((e,s)=>u.jsx("li",{children:e},s))})})]}),y&&u.jsxs(L,{children:[u.jsx(Y,{className:"h-4 w-4"}),u.jsxs(M,{className:"flex items-center justify-between",children:[u.jsx("span",{children:"Didn't receive the verification email?"}),u.jsx(S,{variant:"outline",size:"sm",onClick:()=>d(null,null,function*(){if(a.email){b(!0);try{const{error:e}=yield H.auth.resend({type:"signup",email:a.email});if(e)throw e;X({title:"Verification email sent",description:"Please check your inbox for the verification email."}),w(!1)}catch(e){console.error("Resend error:",e);X({title:"Failed to resend",description:e.message||"Failed to resend verification email. Please try again.",variant:"destructive"})}finally{b(!1)}}else X({title:"Email required",description:"Please enter your email address first.",variant:"destructive"})}),disabled:N,className:"ml-2",children:N?"Sending...":"Resend Email"})]})]}),u.jsxs("div",{className:"space-y-3",children:[u.jsxs(S,{variant:"outline",className:"w-full",type:"button",onClick:()=>se("google"),disabled:r,children:[u.jsxs("svg",{className:"w-5 h-5 mr-2",viewBox:"0 0 24 24",children:[u.jsx("path",{fill:"currentColor",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),u.jsx("path",{fill:"currentColor",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),u.jsx("path",{fill:"currentColor",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),u.jsx("path",{fill:"currentColor",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),"Continue with Google"]}),u.jsxs(S,{variant:"outline",className:"w-full",type:"button",onClick:()=>se("facebook"),disabled:r,children:[u.jsx("svg",{className:"w-5 h-5 mr-2",fill:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{d:"M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"})}),"Continue with Facebook"]}),u.jsxs(S,{variant:"outline",className:"w-full",type:"button",onClick:()=>se("apple"),disabled:r,children:[u.jsx("svg",{className:"w-5 h-5 mr-2",fill:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{d:"M12.152 6.896c-.948 0-2.415-1.078-3.96-1.04-2.04.027-3.91 1.183-4.961 3.014-2.117 3.675-.546 9.103 1.519 12.09 1.013 1.454 2.208 3.09 3.792 3.039 1.52-.065 2.09-.987 3.935-.987 1.831 0 2.35.987 3.96.948 1.637-.026 2.676-1.48 3.676-2.948 1.156-1.688 1.636-3.325 1.662-3.415-.039-.013-3.182-1.221-3.22-4.857-.026-3.04 2.48-4.494 2.597-4.559-1.429-2.09-3.623-2.324-4.39-2.376-2-.156-3.675 1.09-4.61 1.09zM15.53 3.83c.843-1.012 1.4-2.427 1.245-3.83-1.207.052-2.662.805-3.532 1.818-.78.896-1.454 2.338-1.273 3.714 1.338.104 2.715-.688 3.559-1.701"})}),"Continue with Apple"]})]}),u.jsxs("div",{className:"relative",children:[u.jsx($,{}),u.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:u.jsx("span",{className:"bg-background px-4 text-sm text-muted-foreground",children:"OR"})})]}),u.jsxs("form",{onSubmit:e=>d(null,null,function*(){e.preventDefault(),j([]);const s={};if(a.email?Se(a.email)||(s.email="Please enter a valid email address"):s.email="Email is required",a.password?Z&&Z.score<3&&(s.password="Password is too weak. "+Z.feedback):s.password="Password is required",c(s),Object.keys(s).length>0)j(["Please correct the errors above"]);else{l(!0);try{const{data:e,error:s}=yield H.auth.signInWithPassword({email:a.email,password:a.password});if(s)throw s;e.user&&(yield W.trackActivity("user_login",{email:a.email,method:"email"}),X({title:"Login successful",description:"Welcome back to Novaqy!"}),ee("/dashboard"))}catch(t){console.error("Login error:",t);let e="Invalid email or password",s=!1;const a=t;a.message&&(a.message.includes("Email not confirmed")||a.message.includes("email_not_confirmed")?(e="Please confirm your email address before signing in. Check your inbox for the verification email.",s=!0):e=a.message.includes("Invalid login credentials")||a.message.includes("invalid_credentials")?"Invalid email or password. Please check your credentials and try again.":a.message.includes("Too many requests")||a.message.includes("rate_limit")?"Too many login attempts. Please wait a few minutes before trying again.":a.message.includes("User not found")||a.message.includes("user_not_found")?"No account found with this email address. Please sign up first.":a.message.includes("Email link is invalid")||a.message.includes("invalid_email")?"Invalid email format. Please enter a valid email address.":a.message),j([e]),w(s),X({title:"Login failed",description:e,variant:"destructive"})}finally{l(!1)}}}),className:"space-y-4",children:[u.jsxs("div",{className:"space-y-2",children:[u.jsx(O,{htmlFor:"email",children:"Email"}),u.jsx(R,{id:"email",type:"email",value:a.email,onChange:e=>ae("email",e.target.value),placeholder:"Enter your email",required:!0,maxLength:254,autoComplete:"email",className:i.email?"border-red-500":""}),i.email&&u.jsx("p",{className:"text-sm text-red-500",children:i.email})]}),u.jsxs("div",{className:"space-y-2",children:[u.jsx(O,{htmlFor:"password",children:"Password"}),u.jsxs("div",{className:"relative",children:[u.jsx(R,{id:"password",type:e?"text":"password",value:a.password,onChange:e=>ae("password",e.target.value),placeholder:"Enter your password",required:!0,maxLength:128,autoComplete:"current-password",className:i.password?"border-red-500":""}),u.jsx(S,{type:"button",variant:"ghost",size:"sm",className:"absolute right-0 top-0 h-full px-3 hover:bg-transparent",onClick:()=>s(!e),disabled:r,children:e?u.jsx(G,{className:"h-4 w-4"}):u.jsx(U,{className:"h-4 w-4"})})]}),Z&&a.password&&u.jsxs("div",{className:"flex items-center space-x-2",children:[u.jsx("div",{className:"flex-1 bg-gray-200 rounded-full h-2",children:u.jsx("div",{className:"h-2 rounded-full transition-all duration-300 "+(Z.score<=2?"bg-red-500 w-1/3":Z.score<=4?"bg-yellow-500 w-2/3":Z.score<=5?"bg-blue-500 w-4/5":"bg-green-500 w-full")})}),u.jsx("span",{className:`text-sm ${Z.color}`,children:Z.feedback})]}),i.password&&u.jsx("p",{className:"text-sm text-red-500",children:i.password})]}),u.jsx("div",{className:"flex items-center justify-between",children:u.jsx(S,{variant:"link",className:"p-0 h-auto text-sm text-primary hover:underline",type:"button",onClick:()=>_(!0),disabled:r,children:"Forgot password?"})}),u.jsx(S,{type:"submit",className:"w-full",disabled:r,children:r?"Signing In...":"Sign In Securely"})]}),u.jsxs(L,{children:[u.jsx(Y,{className:"h-4 w-4"}),u.jsxs(M,{children:[u.jsx("strong",{children:"Note:"})," Social authentication requires configuration in Supabase Dashboard. Email authentication is ready to use."]})]}),u.jsxs("div",{className:"text-center text-sm",children:["Don't have an account?"," ",u.jsx(P,{to:"/signup",className:"text-primary hover:underline font-medium",children:"Create your account"})]})]})]}),u.jsx(ye,{open:A,onOpenChange:_,children:u.jsxs(be,{children:[u.jsxs(Ae,{children:[u.jsx(ke,{children:"Reset Your Password"}),u.jsx(De,{children:"Enter your email address and we'll send you a link to reset your password."})]}),u.jsx("div",{className:"space-y-4 py-4",children:u.jsxs("div",{className:"space-y-2",children:[u.jsx(O,{htmlFor:"resetEmail",children:"Email Address"}),u.jsx(R,{id:"resetEmail",type:"email",value:C,onChange:e=>T(e.target.value),placeholder:"Enter your email address",required:!0})]})}),u.jsxs(_e,{children:[u.jsx(Ce,{disabled:K,children:"Cancel"}),u.jsx(Pe,{onClick:()=>d(null,null,function*(){if(C)if(/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e=C)&&e.length<=254){var e;Q(!0);try{const{error:e}=yield H.auth.resetPasswordForEmail(C,{redirectTo:`${window.location.origin}/reset-password`});if(e)throw e;X({title:"Password reset email sent",description:"Please check your inbox for password reset instructions."}),_(!1),T("")}catch(s){console.error("Password reset error:",s);X({title:"Failed to send reset email",description:s.message||"Failed to send password reset email. Please try again.",variant:"destructive"})}finally{Q(!1)}}else X({title:"Invalid email",description:"Please enter a valid email address.",variant:"destructive"});else X({title:"Email required",description:"Please enter your email address.",variant:"destructive"})}),disabled:K||!C,children:K?"Sending...":"Send Reset Link"})]})]})}),u.jsx("div",{className:"text-center text-xs text-muted-foreground",children:u.jsxs("p",{children:["By signing in, you agree to our"," ",u.jsx(P,{to:"/terms",className:"hover:underline",children:"Terms of Service"})," ","and"," ",u.jsx(P,{to:"/cookies",className:"hover:underline",children:"Privacy Policy"})]})})]})})};export{Re as default};
