var e=Object.defineProperty,s=Object.defineProperties,a=Object.getOwnPropertyDescriptors,t=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable,i=(s,a,t)=>a in s?e(s,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[a]=t,l=(e,s)=>{for(var a in s||(s={}))n.call(s,a)&&i(e,a,s[a]);if(t)for(var a of t(s))r.call(s,a)&&i(e,a,s[a]);return e},o=(e,t)=>s(e,a(t));import{j as c}from"./ui-vendor-CD6GsE3j.js";import{u as d,k as m,a as u}from"./react-vendor-tk5Uqt6k.js";import{H as h,F as p}from"./Footer-yqS9vQ2S.js";import{I as x,B as g}from"./input-vlty9GQ9.js";import{C as v,b as y,d as f,e as b,a as j}from"./card-KNEg_dmD.js";import{C as N}from"./checkbox-BJT1C8QQ.js";import{L as w}from"./label-CSITrqs2.js";import{B as S}from"./badge-qenvswId.js";import{a as P,b as k}from"./index-CzrRnDKD.js";import{a as C}from"./supabaseService-DdYkWjT-.js";import{d as A,F as D,z as q,u as E,b as I}from"./utils-vendor-cIoDbW7Q.js";import"./separator-BSLEYfof.js";import"./auth-vendor-CP-4ZW6D.js";import"./query-vendor-D3F-YppS.js";const R=()=>{const e=d(),s=m(),{toast:a}=P(),[t,n]=u.useState(!1),[r,i]=u.useState(!1),[R,T]=u.useState({fullName:"",email:"",date:"",ipAddress:"",timestamp:""}),_=(()=>{var a,t,n;const r=new URLSearchParams(e.search);if(r.has("txnid")&&r.has("status")){const e=r.get("txnid"),a=r.get("status");if("success"!==a)return s("/payment/failed"),null;const t={txnid:e,status:a,mihpayid:r.get("mihpayid")||"",firstname:r.get("firstname")||"",amount:r.get("amount")||"",productinfo:r.get("productinfo")||"",email:r.get("email")||"",phone:r.get("phone")||"",mode:r.get("mode")||void 0,bank_ref_num:r.get("bank_ref_num")||void 0,bankcode:r.get("bankcode")||void 0,cardnum:r.get("cardnum")||void 0,cardhash:r.get("cardhash")||void 0,hash:r.get("hash")||void 0};return{transactionId:e,status:a,amount:parseFloat(t.amount||"0"),plan:t.productinfo||"Unknown Plan",customerEmail:t.email||"",payuResponse:t}}return{transactionId:"",status:"success",amount:(null==(a=e.state)?void 0:a.amount)||0,plan:(null==(t=e.state)?void 0:t.plan)||"Unknown Plan",customerEmail:(null==(n=e.state)?void 0:n.customerEmail)||"",payuResponse:null}})(),O=(null==_?void 0:_.plan)||"Unknown Plan",U=(null==_?void 0:_.amount)||0,L=(null==_?void 0:_.customerEmail)||"",[F,M]=u.useState(!1),B=u.useCallback(()=>{return e=null,s=null,t=function*(){if(null==_?void 0:_.payuResponse)try{const e={first_name:_.payuResponse.firstname||"",last_name:"",email:_.payuResponse.email||"",phone:_.payuResponse.phone||"",address:"",city:"",state:"",zip_code:""};(yield C.processPaymentSuccess(_.transactionId,_.payuResponse,e,_.plan,"personal"))?(yield k.trackPaymentSuccess(_.transactionId,_.amount),yield k.trackUserRegistration({email:e.email,plan:_.plan,amount:_.amount})):a({title:"Database Error",description:"Payment was successful but failed to save data. Please contact support.",variant:"destructive"})}catch(e){console.error("Error processing PayU payment:",e),yield k.trackActivity("payment_processing_error",{transaction_id:_.transactionId,error:e instanceof Error?e.message:"Unknown error",plan:_.plan}),a({title:"Processing Error",description:"There was an error processing your payment data.",variant:"destructive"})}finally{M(!1)}},new Promise((a,n)=>{var r=e=>{try{l(t.next(e))}catch(s){n(s)}},i=e=>{try{l(t.throw(e))}catch(s){n(s)}},l=e=>e.done?a(e.value):Promise.resolve(e.value).then(r,i);l((t=t.apply(e,s)).next())});var e,s,t},[_,a]);u.useEffect(()=>{if(!_)return void s("/pricing");_.payuResponse&&_.transactionId&&!F&&(M(!0),B());const e=setTimeout(()=>{n(!0)},2e3);return()=>clearTimeout(e)},[_,s,F,B]);const Y=()=>{if(!R.fullName.trim())return void a({title:"Signature Required",description:"Please enter your full name to sign the agreement.",variant:"destructive"});k.trackActivity("service_agreement_signed",{plan:O,amount:U,customer_email:L,signed_by:R.fullName.trim(),transaction_id:null==_?void 0:_.transactionId});const e=new Date;T(s=>o(l({},s),{email:L,date:e.toLocaleDateString(),timestamp:e.toISOString(),ipAddress:"Captured on form submission"})),i(!0),a({title:"Agreement Signed Successfully",description:"Your service agreement has been digitally signed and recorded."}),console.log("Service Agreement Signed:",{plan:O,amount:U,customerEmail:L,signature:o(l({},R),{fullName:R.fullName.trim(),signedAt:e.toISOString()})})};return t?r?c.jsxs("div",{className:"min-h-screen bg-gradient-subtle",children:[c.jsx(h,{}),c.jsx("div",{className:"container py-20 senior-spacing",children:c.jsxs("div",{className:"max-w-3xl mx-auto text-center",children:[c.jsxs("div",{className:"mb-12",children:[c.jsx(I,{className:"w-24 h-24 text-trust-green mx-auto mb-6"}),c.jsx("h1",{className:"text-5xl font-bold mb-6 text-trust-green senior-text-large",children:"Agreement Signed Successfully!"}),c.jsxs("p",{className:"text-xl text-muted-foreground mb-6 senior-text-medium leading-relaxed",children:["Welcome to Novaqy! Your ",O," is now fully activated and your service agreement has been digitally signed and recorded."]}),c.jsx(S,{variant:"secondary",className:"text-xl px-6 py-3 bg-gradient-primary text-white",children:"Account Active"})]}),c.jsxs(v,{className:"senior-card mb-8",children:[c.jsx(y,{className:"bg-gradient-primary text-white rounded-t-lg",children:c.jsx(f,{className:"text-2xl",children:"Service Agreement Summary"})}),c.jsxs(j,{className:"space-y-4 text-left p-8",children:[c.jsxs("div",{className:"flex justify-between items-center text-lg",children:[c.jsx("span",{className:"font-medium",children:"Plan:"}),c.jsx("span",{className:"font-bold text-trust-blue",children:O})]}),c.jsxs("div",{className:"flex justify-between items-center text-lg",children:[c.jsx("span",{className:"font-medium",children:"Amount Paid:"}),c.jsxs("span",{className:"font-bold text-primary",children:["$",U]})]}),c.jsxs("div",{className:"flex justify-between items-center text-lg",children:[c.jsx("span",{className:"font-medium",children:"Signed By:"}),c.jsx("span",{className:"font-bold",children:R.fullName})]}),c.jsxs("div",{className:"flex justify-between items-center text-lg",children:[c.jsx("span",{className:"font-medium",children:"Signed Date:"}),c.jsx("span",{className:"font-bold",children:R.date})]}),c.jsxs("div",{className:"flex justify-between items-center text-lg",children:[c.jsx("span",{className:"font-medium",children:"Status:"}),c.jsx(S,{variant:"default",className:"text-base px-4 py-2 bg-trust-green text-white",children:"Active"})]})]})]}),c.jsxs("div",{className:"space-y-6",children:[c.jsxs("p",{className:"text-lg text-muted-foreground leading-relaxed",children:["A copy of your signed agreement has been sent to ",L]}),c.jsxs("div",{className:"flex flex-col sm:flex-row gap-6 justify-center",children:[c.jsx(g,{onClick:()=>s("/dashboard"),className:"senior-button flex-1 h-14 text-lg bg-gradient-primary",children:"Go to Dashboard"}),c.jsx(g,{variant:"outline",onClick:()=>s("/contact"),className:"senior-button flex-1 h-14 text-lg",children:"Contact Support"})]})]})]})}),c.jsx(p,{})]}):c.jsxs("div",{className:"min-h-screen bg-background",children:[c.jsx(h,{}),c.jsx("div",{className:"container py-8",children:c.jsxs("div",{className:"max-w-4xl mx-auto",children:[c.jsxs("div",{className:"text-center mb-8",children:[c.jsx(A,{className:"w-16 h-16 text-green-600 mx-auto mb-4"}),c.jsx("h1",{className:"text-3xl font-bold mb-2",children:"Payment Successful!"}),c.jsxs("p",{className:"text-muted-foreground",children:["Your payment of ",U," for ",O," has been processed. Please review and sign your service agreement below."]})]}),c.jsxs(v,{className:"mb-6",children:[c.jsxs(y,{children:[c.jsxs(f,{className:"flex items-center gap-2",children:[c.jsx(D,{className:"w-5 h-5"}),"Service Agreement - ",O]}),c.jsx(b,{children:"Please read and digitally sign this service agreement. This legally binding document protects both parties and helps prevent chargeback disputes."})]}),c.jsxs(j,{className:"space-y-6",children:[c.jsxs("div",{className:"bg-muted/30 p-6 rounded-lg space-y-4 text-sm leading-relaxed max-h-96 overflow-y-auto",children:[c.jsxs("div",{className:"border-b pb-4",children:[c.jsx("h3",{className:"font-semibold text-lg mb-2",children:"Novaqy Managed IT Services Agreement"}),c.jsxs("p",{children:[c.jsx("strong",{children:"Effective Date:"})," ",(new Date).toLocaleDateString()]}),c.jsxs("p",{children:[c.jsx("strong",{children:"Customer:"})," ",L]}),c.jsxs("p",{children:[c.jsx("strong",{children:"Service Plan:"})," ",O]}),c.jsxs("p",{children:[c.jsx("strong",{children:"Payment Amount:"})," ",U," (Annual Subscription)"]}),c.jsxs("p",{children:[c.jsx("strong",{children:"Service Term:"})," 12 months from activation date"]})]}),c.jsxs("div",{children:[c.jsx("h4",{className:"font-semibold mb-2",children:"1. Services Provided"}),c.jsx("p",{children:"Novaqy agrees to provide the managed IT services as described in the selected plan, including remote technical support, system monitoring, security services, and software management as outlined in the plan details. Services are delivered electronically and begin immediately upon payment processing."})]}),c.jsxs("div",{children:[c.jsx("h4",{className:"font-semibold mb-2",children:"2. Payment Terms & Refund Policy"}),c.jsxs("p",{children:["Customer agrees to pay the full amount of ",U," for the selected annual service plan. Payment is due in full at the time of purchase. ",c.jsx("strong",{children:"Refund Policy:"})," Managed services (including bundled software and support) are non-returnable and non-refundable. Due to the immediate delivery of digital services, refunds are not available once service has commenced. Customer may cancel at any time to stop future renewals; no refunds are provided for the remaining term."]})]}),c.jsxs("div",{children:[c.jsx("h4",{className:"font-semibold mb-2",children:"3. Service Delivery & Access"}),c.jsx("p",{children:"Services will be delivered electronically via secure remote access. Customer grants Novaqy permission to access their systems for the purpose of providing technical support and maintenance as described in the service plan. All access is logged and secured according to industry standards. Customer may revoke access at any time by contacting support."})]}),c.jsxs("div",{children:[c.jsx("h4",{className:"font-semibold mb-2",children:"4. Data Protection & Privacy"}),c.jsx("p",{children:"Novaqy will maintain appropriate security measures to protect customer data accessed during service delivery. Customer acknowledges that remote access may involve transmission of diagnostic information and system data necessary for service provision. All data handling complies with applicable privacy laws including PIPEDA (Canada) and relevant US state privacy laws."})]}),c.jsxs("div",{children:[c.jsx("h4",{className:"font-semibold mb-2",children:"5. Service Availability & Support Hours"}),c.jsx("p",{children:"Support is available Monday through Friday, 8:30 AM to 8:30 PM Eastern Time. Emergency monitoring is provided 24/7 for critical systems. Response times vary by service plan: Essential Care (24-48 hours), Advanced Care (12-24 hours), Premium Care (4-12 hours), Family Care (2-8 hours). Customer acknowledges that technology support involves inherent risks and that Novaqy cannot guarantee specific outcomes."})]}),c.jsxs("div",{children:[c.jsx("h4",{className:"font-semibold mb-2",children:"6. Software Licenses & Third-Party Services"}),c.jsx("p",{children:"Where included in the service plan, Novaqy will provide software licenses and manage third-party services. Customer acknowledges that software licenses are provided as-is and subject to the original vendor's terms. Novaqy is not responsible for third-party service outages or changes in vendor policies."})]}),c.jsxs("div",{children:[c.jsx("h4",{className:"font-semibold mb-2",children:"7. Customer Responsibilities"}),c.jsx("p",{children:"Customer agrees to: (a) provide accurate contact and system information, (b) maintain backup copies of important data, (c) follow Novaqy's security recommendations, (d) promptly report any security concerns or system issues, and (e) ensure their systems meet minimum requirements for service delivery."})]}),c.jsxs("div",{children:[c.jsx("h4",{className:"font-semibold mb-2",children:"8. Limitation of Liability"}),c.jsx("p",{children:"Novaqy's liability is limited to the amount paid for services in the preceding 12 months. Customer acknowledges that technology support involves inherent risks and that Novaqy cannot guarantee specific outcomes or prevent all possible issues. Novaqy is not liable for indirect, incidental, or consequential damages."})]}),c.jsxs("div",{children:[c.jsx("h4",{className:"font-semibold mb-2",children:"9. Termination & Cancellation"}),c.jsx("p",{children:"Either party may terminate this agreement with 30 days written notice. Upon termination, Novaqy will cease service delivery and customer will retain access to any provided software licenses according to vendor terms. No refunds will be provided for partial months or unused services."})]}),c.jsxs("div",{children:[c.jsx("h4",{className:"font-semibold mb-2",children:"10. Dispute Resolution"}),c.jsx("p",{children:"Any disputes arising from this agreement will be resolved through good faith negotiation. If resolution cannot be reached, disputes will be subject to binding arbitration in accordance with applicable consumer protection laws. Customer agrees not to initiate chargebacks for digital services that have been delivered."})]}),c.jsxs("div",{children:[c.jsx("h4",{className:"font-semibold mb-2",children:"11. Governing Law"}),c.jsx("p",{children:"This agreement is governed by the laws of Ontario, Canada, and applicable US state laws where services are provided. Customer consents to electronic communication and acknowledges that digital signatures are legally binding and equivalent to handwritten signatures."})]}),c.jsxs("div",{children:[c.jsx("h4",{className:"font-semibold mb-2",children:"12. Entire Agreement"}),c.jsx("p",{children:"This agreement, together with the Terms of Service, Privacy Policy, and Refund Policy, constitutes the entire agreement between the parties. Customer acknowledges that they have read, understood, and agree to be bound by all terms and conditions."})]}),c.jsxs("div",{className:"border-t pt-4 mt-6",children:[c.jsx("h4",{className:"font-semibold mb-2",children:"Acknowledgment of Digital Service Delivery"}),c.jsx("p",{children:"Customer acknowledges that: (a) services are delivered digitally and begin immediately upon payment, (b) digital services cannot be returned once accessed, (c) customer has had opportunity to review service details before purchase, and (d) customer understands the refund policy and service terms."})]})]}),c.jsxs("div",{className:"border-t pt-6 space-y-4",children:[c.jsxs("div",{className:"flex items-center gap-2 text-amber-600 bg-amber-50 p-3 rounded-lg",children:[c.jsx(q,{className:"w-5 h-5"}),c.jsx("span",{className:"text-sm font-medium",children:"This agreement is legally binding and will be used to protect against chargeback disputes"})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[c.jsxs("div",{className:"space-y-2",children:[c.jsx(w,{htmlFor:"fullName",children:"Full Name (Digital Signature) *"}),c.jsx(x,{id:"fullName",value:R.fullName,onChange:e=>T(s=>o(l({},s),{fullName:e.target.value})),placeholder:"Enter your full legal name",required:!0})]}),c.jsxs("div",{className:"space-y-2",children:[c.jsx(w,{children:"Agreement Date"}),c.jsx(x,{value:(new Date).toLocaleDateString(),readOnly:!0,className:"bg-muted"})]})]}),c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx(N,{id:"understand",checked:R.fullName.length>0,onCheckedChange:()=>{}}),c.jsx(w,{htmlFor:"understand",className:"text-sm",children:"I have read and agree to the terms of this service agreement"})]})]})]})]}),c.jsxs("div",{className:"text-center",children:[c.jsxs(g,{onClick:Y,disabled:!R.fullName.trim(),className:"px-8 py-3 text-lg",children:[c.jsx(E,{className:"w-5 h-5 mr-2"}),"Sign Agreement & Complete Setup"]}),c.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:"By signing, you acknowledge that this is a legally binding agreement"})]})]})}),c.jsx(p,{})]}):c.jsxs("div",{className:"min-h-screen bg-background",children:[c.jsx(h,{}),c.jsx("div",{className:"container py-20",children:c.jsxs("div",{className:"max-w-2xl mx-auto text-center",children:[c.jsxs("div",{className:"mb-8",children:[c.jsx(A,{className:"w-20 h-20 text-green-600 mx-auto mb-4"}),c.jsx("h1",{className:"text-4xl font-bold mb-4 text-green-600",children:"Payment Successful!"}),c.jsxs("p",{className:"text-xl text-muted-foreground mb-4",children:["Thank you for choosing Novaqy. Your payment of ",U," for ",O," has been processed successfully.",(null==_?void 0:_.transactionId)&&c.jsxs("span",{className:"block text-sm mt-2",children:["Transaction ID: ",_.transactionId]})]}),c.jsx(S,{variant:"secondary",className:"text-lg px-4 py-2",children:"Account Setup in Progress..."})]}),c.jsx("div",{className:"space-y-4",children:c.jsxs("div",{className:"flex items-center justify-center space-x-2 text-muted-foreground",children:[c.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-primary"}),c.jsx("span",{children:"Preparing your service agreement..."})]})})]})}),c.jsx(p,{})]})};export{R as default};
